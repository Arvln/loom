FROM node:23.9.0-alpine

RUN apk add --no-cache git openssh

WORKDIR /usr/src

COPY ./ ./

ENV CI=true

WORKDIR /usr/src/packages/ui

RUN npm install -g pm2 pnpm && pnpm install --frozen-lockfile

WORKDIR /usr/src/packages/admin-frontend

RUN pnpm install --frozen-lockfile

EXPOSE 5173

CMD ["pm2-runtime", "pnpm", "--", "run", "dev"]
